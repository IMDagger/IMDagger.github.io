dict-set vs hash-set
====================
:date: 2013-12-16 14:46:15
:tags: hash, проблема, производительность, сравнение, dict, racket, generics, словарь
:category: text
:author: IMDagger
:yaru-link: http://imdagger.ya.ru/replies.xml?item_no=1897

Или я не умею варить generics структуры, которые надстроены над
базовыми типами или они не достаточно оптимально
написаны/оптимизируются. Т.к. разрыв по времени довольно большой:

.. code-block:: racket

        > (define x #hash())

        > (time (for ([i (in-range 1000000)]) (dict-set x i i)))
        cpu time: 13728 real time: 13695 gc time: 128

        > (time (for ([i (in-range 1000000)]) (hash-set x i i)))
        cpu time: 376 real time: 375 gc time: 8

Всё таки, различие почти 40x. И аналогичная ситуация для
мутабельного словаря. Я конечно понимаю, что dict-set никак не может
отработать также быстро как hash-set, ибо у него есть дополнительный
функционал и проверки связанные с его универсальностью, но всё же
отличие в 40 раз это для меня слишком, я бы спокойно отнёсся, если бы
было 375 и 500, но не 13695мс. Поэтому пока в критических местах, где
мне не нужна гибкость, буду использовать напрямую hash-set и др.

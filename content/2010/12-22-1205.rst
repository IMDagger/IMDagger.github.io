Тернарная условная операция и and/or
====================================
:date: 2010-12-22 12:08:32
:tags: python, and, оператор, тринарный, or
:category: text
:author: IMDagger
:yaru-link: http://imdagger.ya.ru/replies.xml?item_no=1205

До версии Python 2.5 не было тернарной условной операции вида
в\ *ыражение2 if условие else выражение3*, поэтому приходилось
выкручмиваться через *условие and выражение2 or выражение3*. Получается,
что если условие не ложно, то возвращается выражение2, иначе выражение3.
Но есть подводные камни у and/or, т.к. если само выражение2 не является
истинным, но будут проблемы. Например для пустого списка:

.. code-block:: python

    # эта строчка содержит неявную ошибку
    uids = not isinstance(uids, list) and uids or [uids, ]

Если uids равен 10, то после выполнения кода uids будет равер [10,
]. Всё хорошо, но если uids будет равен [] или {}, то после выполнения
кода uids будет равен [[], ] или [{}, ] соответственно. Что является
неверным. Поэтому в таком операторе, не полностью эквивалентном if,
стоит помнить об истинности выражения2, которое связано с условием через
*and*, т.е. нужно поменять местами выражения:

.. code-block:: python

    # так лучше
    uids = not isinstance(uids, list) and [uids, ] or uids

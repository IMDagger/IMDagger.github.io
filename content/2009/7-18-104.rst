Схема для диалога
=================
:date: 2009-07-18 11:39:58
:tags: xml schema, xsd
:category: text
:author: IMDagger
:yaru-link: http://imdagger.ya.ru/replies.xml?item_no=104

Мне требовалось, чтобы в корневом теге диалога можно было использовать
произвольное число узлов filter, include, define (даже ноль раз) и в
произвольном порядке, а после этого всего объявить **ровно один** узел
talking, который обязательно должен быть. Но возникла проблема, что
:code:`<xsd:all>` позволяет объявить произвольный порядок для дочерних узлов,
но накладывает ограничение: каждый из них встречается ровно 0 или 1 раз.
:code:`<xsd:sequence>` требует строгого порядка объявления узлов, и это мне не
очень подходило. Поискав в рунете что-нибудь внятное я ничего толкового
не нашёл (может плохо искал), кроме аналогичных вопросов на форумах.
Поэтому решил поискать среди англоязычных страниц и нашёл похожий вопрос
и `ответ <http://xsd.stylusstudio.com/2001nov/post03029.htm>`__ на него.

Ответ заключался в том, чтобы рассмотреть проблему с другой стороны. Что
на самом деле мне нужно не просто произвольное число узлов в произвольно
порядке, а произвольное число узлов, каждый из которых выбирается
произвольным образом из заданных мной. Поэтому следовало использовать
:code:`<xsd:choice>` с параметрами :code:`minOccurs` и :code:`maxOccurs`. После этого я
получил такую схему, которая мне и требовалась:

.. code-block:: xml

   <xsd:sequence>
     <xsd:choice minOccurs=“0” maxOccurs=“unbounded”>
       <xsd:element name=“include” type=“IncludeType” />
       <xsd:element name=“filter” type=“FilterType” />
       <xsd:element name=“define” type=“DefineType” />
     </xsd:choice>
     <xsd:element name=“talking” type=“TalkingType” />
   </xsd:sequence>

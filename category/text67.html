<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="utf-8" />
        <title>IMDagger: Дневник</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="" />
        <meta name="author" content="Alex Moiseenko" />
        <!-- Open Graph -->
        <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" />
        <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" />
        <link rel="shortcut icon" href="/favicon.ico" />
        <link rel="stylesheet" href="/theme/css/html4css1.css" />
        <link rel="stylesheet" href="/theme/css/style.css" />
        <link rel="stylesheet" href="/theme/css/pygment.css" />
        <link rel="stylesheet" href="/theme/css/math.css" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
        <script type="text/x-mathjax-config">
         MathJax.Hub.Config({
             'HTML-CSS': {
                 linebreaks: {
                     automatic: true,
                     width: 'container'
                 }
             },
             tex2jax: {
                 inlineMath: [['$math$','$/math$']],
                 displayMath: [['$$math$$','$$/math$$']],
                 skipTags: ['pre', 'code'],
                 preview: ['формула...'],
                 ignoreClass: 'math-ignore'
             }
         });
        </script>
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML"></script>


        <script src="http://s3.amazonaws.com/nwapi/nwmatcher/nwmatcher-1.2.5-min.js"></script>
        <!--[if (gte IE 6)&(lte IE 8)]>
          <script type="text/javascript" src="/theme/js/selectivizr-min.js"></script>
          <noscript><link rel="stylesheet" href="[fallback css]" /></noscript>
        <![endif]-->

        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
        <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
    </head>

    <body>
        <div class="row page-head">
            <div class="row page-head-status page-head-status-top"><div class="col-sm-12 b-status mine"><p><i></i><a href="#" title="настроение" class="b-consistent-link"><b>ни к чему чужое мнение, в моде самовыражение</b></a></p></div></div>
            <div class="col-sm-2 page-left">
                <a href="#">
                    <img src="http://upics.yandex.ru/22199227/normal" ilo-full-src="http://upics.yandex.ru/22199227/normal">
                </a>
            </div>
            <div class="col-sm-10 all-posts">
                <div class="title-container">
                    <h1><b><a href="http://imdagger.github.io/" class="fn nickname">IMDagger</a></b></h1>
                </div>
                <div class="title-menu">
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="active">
                            <a href="#">Дневник</a>
                        </li>
                        <li><a href="#">О себе</a></li>
                        <li><a href="#">Фотки</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="row page-body">
<div class="col-sm-2 page-left">
<div class="row widget widget-photo">
    <a href="posts/2011/08/07/aga-popalsia/" class="b-user-photo__link"><img class="b-user-photo__img" src=" http://img-fotki.yandex.ru/get/5409/22199227.a/0_625fc_e780ccc7_L
?log_nocount=64720402854"></a>
</div><div class="row widget">
    <div class="widget-content b-user-info">
        <div class="widget__body">
            <div class="widget-user-info__age">
                <i class="widget-user-info__sex widget-user-info__sex_type_"></i> 26&nbsp;лет
            </div>
            <div class="widget-user-info__place">
                <a href="#">Гомель</a>,                <a href="#">Беларусь</a>            </div>
            <ul class="contacts">
                <li class="contact contact-type-email"><i></i><a href="mailto:imdagger@yandex.ru">imdagger@yandex.ru</a></li>
                <li class="contact contact-type-ya-online"><i></i>imdagger@ya.ru</li>
                <li class="contact contact-type-icq"><i></i>350395088</li>
            </ul>
        </div>
    </div>
</div>

<div class="row widget">
    <div class="widget-content">
        <div class="widget__title">
            <div class="widget__title-link">Популярное в дневнике</div>
        </div>
        <div class="widget__body">
            <div class="widget-line">
                <div class="widget-entry">
                    <div class="widget-day__title">25&nbsp;июня</div>
                    <div class="widget-entry clearfix">
                        <div class="widget-entry__item">
                            <div class="widget-entry__title">
                                <a href="#" class="h-link">&nbsp;&nbsp;&nbsp; Висцеральная теория сна выглядит стр…</a>
                            </div>
                            <div class="widget-entry__info">2&nbsp;ответа</div>
                        </div>
                    </div>
                </div>
                <div class="widget-entry">
                    <div class="widget-day__title">16&nbsp;мая</div>
                    <div class="widget-entry clearfix">
                        <div class="widget-entry__item">
                            <div class="widget-entry__title">
                                <a href="#" class="h-link">Пожалуй у ByFly сегодня даже более серьё…</a>
                            </div>
                            <div class="widget-entry__info">2&nbsp;ответа</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div></div>

<div class="col-sm-10 all-posts">
<div class="row b-post-filter">
    <span class="pull-right">
        записи по
        <div class="btn-group">
            <span type="button" class="pseudo-link" data-toggle="dropdown">месяцам</span>
            <ul class="dropdown-menu dropdown-menu-right" role="menu">
                <li><a href="#" class="h-link">Нулябрь</a><li>
                <li><a href="#" class="h-link">Первябрь</a><li>
            </ul>
        </div> ·
        <div class="btn-group">
            <span type="button" class="pseudo-link" data-toggle="dropdown">меткам</span>
            <ul class="dropdown-menu dropdown-menu-right" role="menu">                <li>                    <a class="tag-2" href="/tag/linux.html" class="h-link">linux</a>                    <a class="tag-2" href="/tag/iandeks.html" class="h-link">Яндекс</a>                    <a class="tag-1" href="/tag/oshibka.html" class="h-link">ошибка</a>                    <a class="tag-1" href="/tag/bge.html" class="h-link">bge</a>                    <a class="tag-2" href="/tag/eda.html" class="h-link">еда</a>                </li>                <li>                    <a class="tag-1" href="/tag/rabota.html" class="h-link">работа</a>                    <a class="tag-2" href="/tag/sborka.html" class="h-link">сборка</a>                    <a class="tag-1" href="/tag/blender.html" class="h-link">blender</a>                    <a class="tag-1" href="/tag/programmirovanie.html" class="h-link">программирование</a>                    <a class="tag-1" href="/tag/radost.html" class="h-link">радость</a>                </li>                <li>                    <a class="tag-2" href="/tag/emacs.html" class="h-link">emacs</a>                    <a class="tag-1" href="/tag/ia.html" class="h-link">Я</a>                    <a class="tag-1" href="/tag/zhizn.html" class="h-link">жизнь</a>                    <a class="tag-2" href="/tag/bredni.html" class="h-link">бредни</a>                    <a class="tag-2" href="/tag/java.html" class="h-link">java</a>                </li>                <li>                    <a class="tag-2" href="/tag/google.html" class="h-link">google</a>                    <a class="tag-1" href="/tag/nabrosok.html" class="h-link">набросок</a>                    <a class="tag-1" href="/tag/python.html" class="h-link">python</a>                    <a class="tag-2" href="/tag/javascript.html" class="h-link">javascript</a>                    <a class="tag-2" href="/tag/icfpc.html" class="h-link">icfpc</a>                </li>            </ul>
        </div> ·
        <div class="btn-group">
            <span type="button" class="pseudo-link" data-toggle="dropdown">типам</span>
            <ul class="dropdown-menu dropdown-menu-right" role="menu">
                <li><a href="/category/description.html" class="h-link">обращение</a><li>
                <li><a href="/category/friend.html" class="h-link"></a><li>
                <li><a href="/category/join.html" class="h-link"></a><li>
                <li><a href="/category/link.html" class="h-link">ссылки</a><li>
                <li><a href="/category/mood.html" class="h-link">настроение</a><li>
                <li><a href="/category/photo.html" class="h-link">фото</a><li>
                <li><a href="/category/text.html" class="h-link">текст</a><li>
                <li><a href="/category/video.html" class="h-link">видео</a><li>
                <li><a href="/category/wishlist.html" class="h-link"></a><li>
            </ul>
        </div>
    </span>
</div>
    <div class="row b-post">
<div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="/posts/2009/10/08/dlia-frendzonshchikov/" >
                8 октября 2009 года, 21:08
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
<div class="row tags-row">
    <span class="tag"><a class="h-link" href="/tag/ia.html">Я</a></span>,    <span class="tag"><a class="h-link" href="/tag/pechal.html">печаль</a></span>,    <span class="tag"><a class="h-link" href="/tag/serdtse.html">сердце</a></span>,    <span class="tag"><a class="h-link" href="/tag/bredni.html">бредни</a></span></div>
            <div class="post-title">
<a class="no-link" href="/posts/2009/10/08/dlia-frendzonshchikov/">Для френдзонщиков :)</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<div class="line-block">
<div class="line">Да я знаю, я только лишь друг</div>
<div class="line">И не хочется верить мне в это,</div>
<div class="line">А хотел я поверить, что вдруг</div>
<div class="line">В твоём сердце есть тёплое лето.</div>
<div class="line">Жаль, что это не так — я не нужен,</div>
<div class="line">Ждёт меня там дождливая осень,</div>
<div class="line">Тихо ходит блуждая по лужам,</div>
<div class="line">Лишь оставит следы и не спросит,</div>
<div class="line">Почему во мне след так болит,</div>
<div class="line">И не дал этой ране зажить</div>
<div class="line">Даже, если сердечко горит,</div>
<div class="line">Не могу туда больше пустить.</div>
<div class="line">Но вот разум решил победить,</div>
<div class="line">Когда понял намёки молчаний,</div>
<div class="line">Мои чувства могли навредить</div>
<div class="line">Или взглядом во время прощаний.</div>
<div class="line">Стану снова, как раньше спокойным</div>
<div class="line">Превратив все эмоции в грани.</div>
<div class="line">Всё сломав мне не выйти достойным,</div>
<div class="line">Не зажить той зияющей ране.</div>
<div class="line">Не позволю лишиться общения,</div>
<div class="line">Всё припрячу, уже не забрать.</div>
<div class="line">Как ребёнок прижму без стеснения,</div>
<div class="line">Сберегу, что смогла мне ты дать.</div>
<div class="line">Ну, а если растает однажды</div>
<div class="line">Огорчусь, но ты не узнаешь.</div>
<div class="line">Одна радость была, но не важно</div>
<div class="line">Ведь я чувствую — ты отбираешь.</div>
<div class="line">А возможно бы просто заплакал,</div>
<div class="line">Вот такая вот детская слабость,</div>
<div class="line">Через маску бы тихо закапал</div>
<div class="line">Прямиком на поддельную радость.</div>
<div class="line">Или я весь пропитан жестокостью?</div>
<div class="line">И не смыслю в делах таких нежных,</div>
<div class="line">И не знаю подходов всех с тонкостью</div>
<div class="line">Результатов деяний небрежных.</div>
<div class="line">Мои чувства внутри обитали —</div>
<div class="line">Поделом за такую ошибку.</div>
<div class="line">Строю вечный замок печали,</div>
<div class="line">Не вернуть себе снова улыбку.</div>
</div>
                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div><div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="/posts/2009/10/08/ia-brezhu/" >
                8 октября 2009 года, 20:22
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
<div class="row tags-row">
    <span class="tag"><a class="h-link" href="/tag/bredni.html">бредни</a></span></div>
            <div class="post-title">
<a class="no-link" href="/posts/2009/10/08/ia-brezhu/">Я брежу</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<p>&nbsp; &nbsp; В саду росла чудесная роза, к ней прилетали бабочки и нежно
топтались своими лапками и собирали нектар. Роза себя чувствовала нужной
и полезной, в ней царила гармония и спокойствие. Но однажды рядом стал
прорастать вьюнок, он груб и прост, но он тоже хотел любви. Роза ему
очень понравилась и он решил, что это его судьба и можно взять так
просто и прорасти. Она иногда разрешала ему расти, но всё чаще пыталась
ранить шипами. Он стал изо дня в день оплетать её, не понимая, что
губит… Он просто хотел цвести вместе, наслаждаться тем, что для неё было
всегда. Но разрушив розу, он и сам погиб, потому что не мог существовать
без неё :(.</p>
                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div><div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="/posts/2009/10/07/uuups/" >
                7 октября 2009 года, 17:39
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
<div class="row tags-row">
    <span class="tag"><a class="h-link" href="/tag/blender.html">blender</a></span>,    <span class="tag"><a class="h-link" href="/tag/oboi.html">обои</a></span>,    <span class="tag"><a class="h-link" href="/tag/robot.html">робот</a></span></div>
            <div class="post-title">
<a class="no-link" href="/posts/2009/10/07/uuups/">Ууупс...</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<p>Я очень невнимательный <strong>:S</strong> и когда рендерил это изображение в
прошлый раз, то забыл (<del class="del">
т.к. на самом деле пришлось скопировать файлы на
более мощную машинку</del>
) включить слой с лампочкой. И от этого нос пропал и
меня мучали вопросы: «Что в нём изменилось в сравнении с первоначальным
вариантом?», но мне подсказали и я наконец-то добавил. Вот окончательный
результат:</p>
<p><a class="reference external" href="http://fotki.yandex.ru/users/imdagger/view/89181/"><img alt='Робот "с носом"' src="http://img-fotki.yandex.ru/get/3800/imdagger.3/0_15c5d_77e7a4ed_XL" style="width: 400px; height: 300px;" title='Робот "с носом"'/></a></p>                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div><div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="/posts/2009/10/06/oshibka-v-moei-dnk-tsepochke/" >
                6 октября 2009 года, 18:52
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
<div class="row tags-row">
    <span class="tag"><a class="h-link" href="/tag/python.html">python</a></span>,    <span class="tag"><a class="h-link" href="/tag/jython.html">jython</a></span>,    <span class="tag"><a class="h-link" href="/tag/sspi.html">SSPI</a></span>,    <span class="tag"><a class="h-link" href="/tag/jtds.html">jtds</a></span></div>
            <div class="post-title">
<a class="no-link" href="/posts/2009/10/06/oshibka-v-moei-dnk-tsepochke/">Ошибка в моей ДНК-цепочке</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<p>Сегодня снова воевал с jTDS и MSSQL. Нужно было, чтобы моё
приложение, которое было написано ещё в прошлом году на Jython, было
немного модифицировано и работало на другом компьютере. Но как и в
прошлый раз (моя глупая голова забыла все прошлогодние шишки) я
вспоминал куда нужно положить этот ntlmauth.dll. Снача оно мне сказало:
<code class="code">
Native SSPI library not loaded. Check the java.library.path system
property</code>
. Поэтому я проверил его значение:</p>
<div class="highlight"><pre><span class="pgcss-gp">&gt;&gt;&gt; </span><span class="pgcss-kn">from</span> <span class="pgcss-nn">java.lang</span> <span class="pgcss-kn">import</span> <span class="pgcss-n">System</span>
<span class="pgcss-gp">&gt;&gt;&gt; </span><span class="pgcss-n">System</span><span class="pgcss-o">.</span><span class="pgcss-n">getProperty</span><span class="pgcss-p">(</span><span class="pgcss-s">&quot;java.library.path&quot;</span><span class="pgcss-p">)</span>
<span class="pgcss-go">тут оно выдало директории</span>
</pre></div>
<p>Но я решил вместо того, чтобы скопировать файл ntlm.dll, а затем
запустить приложение, загрузил Jython и подкючил классы для соединения с
базой, а во время этого скопировал динамическую библиотеку (даже в
jdk/bin и jre/bin положил x-D):</p>
<div class="highlight"><pre><span class="pgcss-gp">&gt;&gt;&gt; </span><span class="pgcss-kn">from</span> <span class="pgcss-nn">com.ziclix.python.sql</span> <span class="pgcss-kn">import</span> <span class="pgcss-n">zxJDBC</span>
<span class="pgcss-gp">&gt;&gt;&gt; </span><span class="pgcss-n">url</span> <span class="pgcss-o">=</span> <span class="pgcss-s">&#39;jdbc:jtds:sqlserver://</span><span class="pgcss-si">%s</span><span class="pgcss-s">/</span><span class="pgcss-si">%s</span><span class="pgcss-s">;domain=</span><span class="pgcss-si">%s</span><span class="pgcss-s">;piped=true&#39;</span> <span class="pgcss-o">%</span>\
<span class="pgcss-go">             (&#39;SERVER&#39;, &#39;WorkDB&#39;, &#39;DOMAIN&#39;)</span>
<span class="pgcss-gp">&gt;&gt;&gt; </span><span class="pgcss-n">db</span> <span class="pgcss-o">=</span> <span class="pgcss-n">zxJDBC</span><span class="pgcss-o">.</span><span class="pgcss-n">connect</span><span class="pgcss-p">(</span><span class="pgcss-n">url</span><span class="pgcss-p">,</span> <span class="pgcss-s">&#39;&#39;</span><span class="pgcss-p">,</span> <span class="pgcss-s">&#39;&#39;</span><span class="pgcss-p">,</span>  <span class="pgcss-c"># имя и пароль не нужны из-за NTLM</span>
<span class="pgcss-go">             &#39;net.sourceforge.jtds.jdbc.Driver&#39;,</span>
<span class="pgcss-go">             CHARSET=&#39;utf-8&#39;)</span>
</pre></div>
<p>На что оно мне радостно заявило исключением, я даже пытался создать
вручную загрузку библиотеки при помощи <code class="code">
SSPIJNIClient.getInstance()</code>
, но
каждый раз натыкался на <code class="code">
java.lang.Exception: Native SSPI library not
loaded</code>
. Тогда я  нашёл исходники jTDS, отыскал класс SSPIJNIClient и
понял, что он лишь один раз пытается инициализировать свои статические
методы и загрудить ntlmauth:</p>
<div class="highlight"><pre><span class="pgcss-kd">static</span> <span class="pgcss-o">{</span>
    <span class="pgcss-k">try</span> <span class="pgcss-o">{</span>
        <span class="pgcss-n">System</span><span class="pgcss-o">.</span><span class="pgcss-na">loadLibrary</span><span class="pgcss-o">(</span><span class="pgcss-s">&quot;ntlmauth&quot;</span><span class="pgcss-o">);</span>
        <span class="pgcss-n">SSPIJNIClient</span><span class="pgcss-o">.</span><span class="pgcss-na">libraryLoaded</span> <span class="pgcss-o">=</span> <span class="pgcss-kc">true</span><span class="pgcss-o">;</span>
    <span class="pgcss-o">}</span> <span class="pgcss-k">catch</span> <span class="pgcss-o">(</span><span class="pgcss-n">UnsatisfiedLinkError</span> <span class="pgcss-n">err</span><span class="pgcss-o">)</span> <span class="pgcss-o">{</span>
        <span class="pgcss-n">Logger</span><span class="pgcss-o">.</span><span class="pgcss-na">println</span><span class="pgcss-o">(</span><span class="pgcss-s">&quot;Unable to load library: &quot;</span> <span class="pgcss-o">+</span> <span class="pgcss-n">err</span><span class="pgcss-o">);</span>
    <span class="pgcss-o">}</span>
<span class="pgcss-o">}</span>
</pre></div>
<p>Поэтому всё решилось просто выходом из оболочки Jython и загрузкой
заново x-D.</p>
                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div><div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="/posts/2009/10/05/muchaius/" >
                5 октября 2009 года, 20:41
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
<div class="row tags-row">
    <span class="tag"><a class="h-link" href="/tag/java.html">java</a></span>,    <span class="tag"><a class="h-link" href="/tag/hibernate.html">hibernate</a></span></div>
            <div class="post-title">
<a class="no-link" href="/posts/2009/10/05/muchaius/">Мучаюсь</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<p>Эх, приходится переносить комплексные запросы на Hibernate и
мучаться. Но всё же нашёл кое-какое решение для создания объектов,
оказывается можно в HQL писать <code class="code">
select new MyMegaClass(параметры, …)
from OtherClass left join и т.д.</code>
. Что позволит мне создавать
объекты другого типа.</p>
<p>Я как-то не обращал на это внимание, пока не наткнулся
<a class="reference external" href="http://www.javalobby.org/articles/hibernate-query-101/">тут</a>.</p>
                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div><div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="/posts/2009/10/04/gliuki/" >
                4 октября 2009 года, 18:19
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
<div class="row tags-row">
    <span class="tag"><a class="h-link" href="/tag/slang.html">slang</a></span>,    <span class="tag"><a class="h-link" href="/tag/ncurses.html">ncurses</a></span>,    <span class="tag"><a class="h-link" href="/tag/midnight-commander.html">midnight commander</a></span></div>
            <div class="post-title">
<a class="no-link" href="/posts/2009/10/04/gliuki/">Глюки</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<p>Собрал Midnight Commander с Ncurses, но появились проблемы: после
выполнения команды <strong>reset</strong> прямо из mc, в нём исчезала вся
псевдографика (т.е. вертикальные, горизонтальные линии и т.д.) и
появлялись вместо них буквы «x», а вторая проблема заключалась в
зависании Midnight Commander’а и загрузке процессора на 100% при
закрытии терминала, <u class="underline">
а не выхода по</u>
 <kbd class="kbd">
F10</kbd>
. Решились они обе установкой
S-Lang и сборкой с ним (по умолчанию с libslang и собирается, но я
принудительно задавал <strong>--with-screen=ncurses</strong>).</p>
                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div><div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="/posts/2009/10/01/stranno/" >
                1 октября 2009 года, 21:26
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
<div class="row tags-row">
    <span class="tag"><a class="h-link" href="/tag/python.html">python</a></span>,    <span class="tag"><a class="h-link" href="/tag/http.html">HTTP</a></span></div>
            <div class="post-title">
<a class="no-link" href="/posts/2009/10/01/stranno/">Странно</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<p>Странно, что при передаче POST-запроса при помощи httplib (из
стандартной поставки Python), данные формы отправляются как-то позже,
только после уничтожения объекта соединения, а не во время вызова
<em>request</em>:</p>
<div class="highlight"><pre><span class="pgcss-n">conn</span> <span class="pgcss-o">=</span> <span class="pgcss-n">httplib</span><span class="pgcss-o">.</span><span class="pgcss-n">HTTPConnection</span><span class="pgcss-p">(</span><span class="pgcss-s">&#39;localhost&#39;</span><span class="pgcss-p">,</span> <span class="pgcss-mi">8080</span><span class="pgcss-p">)</span>
<span class="pgcss-n">params</span> <span class="pgcss-o">=</span> <span class="pgcss-n">urllib</span><span class="pgcss-o">.</span><span class="pgcss-n">urlencode</span><span class="pgcss-p">({</span><span class="pgcss-s">&#39;name&#39;</span><span class="pgcss-p">,</span> <span class="pgcss-s">&#39;а тут данные много-много&#39;</span><span class="pgcss-p">})</span>
<span class="pgcss-n">headers</span> <span class="pgcss-o">=</span> <span class="pgcss-p">{</span><span class="pgcss-s">&#39;Content&#39;</span><span class="pgcss-o">-</span><span class="pgcss-nb">type</span> <span class="pgcss-p">:</span> <span class="pgcss-s">&#39;application/x-www-form-urlencoded&#39;</span><span class="pgcss-p">,</span> <span class="pgcss-s">&#39;Accept&#39;</span> <span class="pgcss-p">:</span> <span class="pgcss-s">&#39;text&#39;</span><span class="pgcss-o">/</span><span class="pgcss-n">plain</span><span class="pgcss-p">}</span>
<span class="pgcss-n">conn</span><span class="pgcss-o">.</span><span class="pgcss-n">request</span><span class="pgcss-p">(</span><span class="pgcss-s">&#39;POST&#39;</span><span class="pgcss-p">,</span> <span class="pgcss-s">&#39;/test/test.jsp&#39;</span><span class="pgcss-p">,</span> <span class="pgcss-n">params</span><span class="pgcss-p">,</span> <span class="pgcss-n">headers</span><span class="pgcss-p">)</span>
<span class="pgcss-n">response</span> <span class="pgcss-o">=</span> <span class="pgcss-n">conn</span><span class="pgcss-o">.</span><span class="pgcss-n">getresponse</span><span class="pgcss-p">()</span>
<span class="pgcss-n">data</span> <span class="pgcss-o">=</span> <span class="pgcss-n">response</span><span class="pgcss-o">.</span><span class="pgcss-n">read</span><span class="pgcss-p">()</span>
</pre></div>
<p>Но read возвращает данные от скрипта будто параметры и не
передавались при помощи POST. Методом проб и ошибок я понял, что тело
HTTP запроса не отправляется. И заменил на другой код с использованием
urllib, который к счастью заработал:</p>
<div class="highlight"><pre><span class="pgcss-n">params</span> <span class="pgcss-o">=</span> <span class="pgcss-n">urllib</span><span class="pgcss-o">.</span><span class="pgcss-n">urlencode</span><span class="pgcss-p">({</span><span class="pgcss-s">&#39;name&#39;</span><span class="pgcss-p">,</span> <span class="pgcss-s">&#39;а тут данные много-много&#39;</span><span class="pgcss-p">})</span>
<span class="pgcss-n">response</span> <span class="pgcss-o">=</span> <span class="pgcss-n">urllib</span><span class="pgcss-o">.</span><span class="pgcss-n">urlopen</span><span class="pgcss-p">(</span><span class="pgcss-s">&#39;http://localhost:8080/test/test.jsp&#39;</span><span class="pgcss-p">,</span> <span class="pgcss-n">params</span><span class="pgcss-p">)</span>
<span class="pgcss-n">data</span> <span class="pgcss-o">=</span> <span class="pgcss-n">response</span><span class="pgcss-o">.</span><span class="pgcss-n">read</span><span class="pgcss-p">()</span>
</pre></div>
<p>И оп! Он смог переслать тело запроса через сокет. А почему с httplib
не получилось я даже пока не знаю.</p>
<p>P.S. Давно что-то я про Python не писал :)</p>
                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div><div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="/posts/2009/10/01/tortik/" >
                1 октября 2009 года, 20:35
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
<div class="row tags-row">
    <span class="tag"><a class="h-link" href="/tag/tort.html">торт</a></span></div>
            <div class="post-title">
<a class="no-link" href="/posts/2009/10/01/tortik/">Тортик</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<p>Полторы недели назад кушал вкусный тортик, который сделала мама. Масса
его была ~7кг. Цветок и лепестки сделаны из сахара.</p>
<p class="text-center"><a class="reference external" href="http://fotki.yandex.ru/users/imdagger/view/86328/"><img alt="Торт" src="http://img-fotki.yandex.ru/get/3802/imdagger.3/0_15138_951b13a1_XL" style="width: 400px; height: 300px;" title="Торт"/></a></p>
<p class="text-center"><a class="reference external" href="http://fotki.yandex.ru/users/imdagger/view/86327/"><img alt="Торт" src="http://img-fotki.yandex.ru/get/3714/imdagger.3/0_15137_40a6e763_XL" style="width: 400px; height: 300px;" title="Торт"/></a></p>                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div><div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="/posts/2009/09/30/bukvennoe-pechene/" title="изменено 13 июля 2014 года в 16:45">
                30 сентября 2009 года, 11:49
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
<div class="row tags-row">
    <span class="tag"><a class="h-link" href="/tag/pechene.html">печенье</a></span>,    <span class="tag"><a class="h-link" href="/tag/gotovliu.html">готовлю</a></span>,    <span class="tag"><a class="h-link" href="/tag/eda.html">еда</a></span>,    <span class="tag"><a class="h-link" href="/tag/ovsianoe.html">овсяное</a></span>,    <span class="tag"><a class="h-link" href="/tag/kukhnia.html">кухня</a></span></div>
            <div class="post-title">
<a class="no-link" href="/posts/2009/09/30/bukvennoe-pechene/">Буквенное печенье</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<p>Вчера вечером сделал овсяное печенье. Приготовилось всё очень
быстро.</p>
<p class="text-center"><a class="reference external" href="http://fotki.yandex.ru/users/imdagger/view/85512/"><img alt="Печенье IMDagger" src="http://img-fotki.yandex.ru/get/3712/imdagger.3/0_14e08_8bf120d1_-1-XL.jpg" style="width: 400px; height: 251px;" title="Печенье IMDagger"/></a></p>
<p>Чем-то я себе напомнил Шелдона Купера из «Теории большого взрыва»,
только я умею хорошо готовить яичницу и несколькими способами ;)… Я
приготовил печенье, затем порпобовал кусочек, пошёл записал заметку в
трофейный блокнот, потом пошёл за фотоаппаратом, сфотографировал
печенье, снова его попробовал, пошёл сделал заметку в трофейную записную
книгу:</p>
<p>Запомнить:</p>
<ol class="arabic simple">
<li>В следующий раз сократить количество маргарина с 300гр до 150гр;</li>
<li>Не использовать бумагу для выпечки и не смазывать её маргарином;</li>
<li>Ложить прямо на противень, после того, как появится слабая корочка
вокруг печенья, то добавить на него кусочек маргарина.</li>
</ol>
<p>Сделал верно:</p>
<ol class="arabic simple">
<li>В моей духовке 150C оптимальная температура, хоть и в рецепте
написано 200C;</li>
<li>Гашеная сода сама приподнимает центр печенья (это видно на
кругленьких).</li>
</ol>
<p>И вообще все мои действия напоминают мне <del class="del">
Шелдона Купера</del>
 кого-то. Я
знал, что я <strong>geek</strong>, но не думал, что я настолько соответствую шуткам
:). Получилось вкусно, но хочу отточить навыки и ещё потренируюсь.</p>                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div><div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="/posts/2009/09/28/klonirovanie-obrazov/" >
                28 сентября 2009 года, 14:16
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
<div class="row tags-row">
    <span class="tag"><a class="h-link" href="/tag/clonezilla.html">clonezilla</a></span>,    <span class="tag"><a class="h-link" href="/tag/samba4.html">samba4</a></span>,    <span class="tag"><a class="h-link" href="/tag/vosstanovlenie.html">восстановление</a></span>,    <span class="tag"><a class="h-link" href="/tag/boot.html">boot</a></span>,    <span class="tag"><a class="h-link" href="/tag/drbl.html">drbl</a></span></div>
            <div class="post-title">
<a class="no-link" href="/posts/2009/09/28/klonirovanie-obrazov/">Клонирование образов</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<p>В моей ситуации PDC сервером является <strong>Samba 4.0.0-alpha9</strong> из GIT.
А клиентские компьютеры под управлением Window$ XP. Был сделан новый
образ с одного компьютера, чтобы поставить его на все остальные
(разметка таже, только операционная система обновлена). Я решил, что
удобнее хранить на сервере одну копию образа и восстанавливать её по
сети, используя PXE для загрузки.</p>
<p>Первая проблема, которая встала передо мной — при попытке
восстановления образа выпадала ошибка, что не удалось клонировать sda2
(но mbr <del class="del">
сволочь</del>
 всё таки Clonezilla заменила). Забавно было, что
разбивка на компьютерах одна и также, но я заметил, что создавал образ с
<strong>sda1</strong>, а пытался восстановить на <strong>sda2</strong> такой же по размеру и
<u class="underline">
начинающийся в тех же секторах</u>
. Тогда я залез в папку с образом (у меня
/home/partimag) и поправил файлы:</p>
<blockquote>
<div class="line-block">
<div class="line">/home/partimag/имя-образа/parts:</div>
<div class="line">было <strong>sda1</strong> стало <strong>sda2</strong></div>
<div class="line">/home/partimag/имя-образа/sda-pt.parted</div>
<div class="line">Поменял номера разделов (поле Number)</div>
<div class="line"><strong>1</strong> &lt;-&gt; <strong>2</strong></div>
<div class="line">/home/partimag/имя-образа/sda-pt.sf</div>
<div class="line">Обменял <strong>sda1</strong> &lt;-&gt; <strong>sda2</strong> (<strong>sda1</strong> - это диск D:)</div>
</div>
</blockquote>
<p>После этих хитрых манипуляций образ поставился, но система наотрез
отказалась запускаться ссылаясь на «повреждённый hal.dll». Снова
поразмыслив, я написал небольшой скрипт и положил его в
<strong>/opt/drbl/share/drbl/postrun</strong>, чтобы после успешного клонирования был
он вызван и исправил в boot.ini на диске строки partition(1) на
partition(<strong>id</strong>), где id — номер раздела, который загрузочный.</p>
<div class="alert  alert-danger compound">
<p><strong>Осторожно!</strong> Если не понятно, что делает этот скрипт, то не при каких
обстоятельствах его не использовать, т.к. он производит слишком
мало проверок на корректность своих действий (и обрабатывает только
sda1, sda2, hda1, hda2 и только ntfs), а также пользуется пакетом
ntfsprogs, который должен быть <strong>обязательно установлен</strong></p>
</div>
<p class="cut"><a class="h-link reference internal" href="#cut_58705808"data-toggle="collapse">хочу узреть программу!</a></p>
<div class="collapse" id="cut_58705808">
<div class="highlight"><pre><span class="pgcss-c">#! /bin/sh</span>
<span class="pgcss-k">for </span>id in 1 2; <span class="pgcss-k">do</span>
<span class="pgcss-k">   for </span>hdd in hda sda; <span class="pgcss-k">do</span>
<span class="pgcss-k">      </span><span class="pgcss-nv">disk</span><span class="pgcss-o">=</span><span class="pgcss-nv">$hdd$id</span>
      <span class="pgcss-nb">echo</span> <span class="pgcss-s2">&quot;Trying $disk ...&quot;</span>

      <span class="pgcss-k">if</span> <span class="pgcss-o">[</span> ! -z <span class="pgcss-sb">`</span>ntfsls -f /dev/<span class="pgcss-nv">$disk</span> <span class="pgcss-se">\|</span> grep boot.ini<span class="pgcss-sb">`</span> <span class="pgcss-o">]</span>; <span class="pgcss-k">then</span>
<span class="pgcss-k">         </span><span class="pgcss-nb">echo</span> <span class="pgcss-s2">&quot;Found primary boot disk ...&quot;</span>
         ntfscat -f /dev/<span class="pgcss-nv">$disk</span> boot.ini &gt;/root/boot.ini
         <span class="pgcss-k">if</span> <span class="pgcss-o">[</span> -z <span class="pgcss-sb">`</span>cat /root/boot.ini<span class="pgcss-sb">`</span> <span class="pgcss-o">]</span>; <span class="pgcss-k">then</span>
<span class="pgcss-k">            </span><span class="pgcss-nb">echo</span> <span class="pgcss-s2">&quot;Error!&quot;</span>
            <span class="pgcss-nb">exit </span>1;
         <span class="pgcss-k">fi</span>

<span class="pgcss-k">         </span><span class="pgcss-nb">echo</span> <span class="pgcss-s2">&quot;Try to fix disk ...&quot;</span>
         ntfsfix /dev/<span class="pgcss-nv">$disk</span>
         sed <span class="pgcss-s2">&quot;s/\(.*\)partition([01234]\?)\(.*\)/\1partition($id)\2/&quot;</span> /root/boot.ini &gt;/root/boot_new.ini
         <span class="pgcss-nb">echo</span> <span class="pgcss-s2">&quot;Replace boot.ini by new&quot;</span>
         ntfscp -f /dev/<span class="pgcss-nv">$disk</span> /root/boot_new.ini boot.ini
      <span class="pgcss-k">else</span>
<span class="pgcss-k">         </span><span class="pgcss-nb">echo</span> <span class="pgcss-s2">&quot;Not found boot.ini&quot;</span>
      <span class="pgcss-k">fi</span>
<span class="pgcss-k">   done</span>
<span class="pgcss-k">done</span>
</pre></div>
</div>
<p>Вуаля и о чудо, винда загрузилась… Но… при попытке ввести в домен
выпала ошибка «Именам пользователей не сопоставлены коды защиты данных».
Я заглянул на сервер в LDAP-директорию и обнаружил компьютер 2-5-9 с
CN=2-5-0, а именем 2-5-9. Ясно, что из-за одинакового имени всех
компьютеров из образа — 2-5-0 (можно было раздавать имена средствами
Clonezilla, там есть даже галочка для этого, но мне было лень делать
список MAC-адресов). Тогда, чтобы эта ошибка не выпадала, я:</p>
<ol class="arabic simple">
<li>Удалил запись 2-5-0 из LDAP от Samba4;</li>
<li>Переименовывал машины без ввода в домен и с перезагрузкой;</li>
<li>Только после перезагрузки вводил в домен.</li>
<li>И вот всё заработало как надо.</li>
</ol>
                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div>        <div class="panel panel-default">
            <div class="panel-body more">
                <span class="less-prev"><a class="h-link" href="category/text66.html">Назад</a></span>
                <span class="more-next"><a class="h-link" href="category/text68.html">Ещё записи</a></span>
            </div>
        </div>
    </div>
</div>
        </div>
<!-- Yandex.Metrika informer --><a href="https://metrika.yandex.ru/stat/?id=25746494&amp;from=informer" target="_blank" rel="nofollow"><img src="//bs.yandex.ru/informer/25746494/3_1_FFFFFFFF_EFEFEFFF_0_pageviews" style="width:88px; height:31px; border:0;" alt="Яндекс.Метрика" title="Яндекс.Метрика: данные за сегодня (просмотры, визиты и уникальные посетители)" onclick="try{Ya.Metrika.informer({i:this,id:25746494,lang:'ru'});return false}catch(e){}"/></a><!-- /Yandex.Metrika informer --><!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter25746494 = new Ya.Metrika({id:25746494, clickmap:true, trackLinks:true, accurateTrackBounce:true}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="//mc.yandex.ru/watch/25746494" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter -->    </body>
</html>
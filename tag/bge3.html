<!DOCTYPE html>
<html lang="ru">
    <head>
        <meta charset="utf-8" />
        <title>IMDagger: Дневник</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="description" content="Блог IMDagger: IT и жизнь" />
        <meta name="keywords" content="python,lisp,scheme,racket,emacs,blender,программирование,моделирование,lua,c++,c,js,java,git,bazaar" />
        <meta name="author" content="Alex Moiseenko (IMDagger)" />

<meta name="robots" content="noindex"/>
        <!-- Open Graph -->
        <link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css" />
        <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css" />
        <link rel="shortcut icon" href="http://imdagger.github.io/favicon.ico" />
        <link rel="stylesheet" href="/theme/css/html4css1.css" />
        <link rel="stylesheet" href="/theme/css/style.css" />
        <link rel="stylesheet" href="/theme/css/pygment.css" />
        <link rel="stylesheet" href="/theme/css/math.css" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
        <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
        <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML,http://imdagger.github.io/theme/js/math.js"></script>
        <script src="http://s3.amazonaws.com/nwapi/nwmatcher/nwmatcher-1.2.5-min.js"></script>
        <!--[if (gte IE 6)&(lte IE 8)]>
          <script type="text/javascript" src="/theme/js/selectivizr-min.js"></script>
          <noscript><link rel="stylesheet" href="[fallback css]" /></noscript>
        <![endif]-->

        <!-- HTML5 shim, for IE6-8 support of HTML5 elements -->
        <!--[if lt IE 9]>
        <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
        <![endif]-->
        <link href="http://imdagger.github.io/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="IMDagger Atom-лента" />
    </head>

    <body>
        <div class="row page-head">
            <div class="row page-head-status page-head-status-top"><div class="col-sm-12 b-status mine"><p><i></i><a href="#" title="настроение" class="b-consistent-link"><b>Продать кому-то что-то всегда на деле сложнее, чем кажется</b></a></p></div></div>
            <div class="col-sm-2 page-left">
                <a href="#">
                    <img src="http://upics.yandex.ru/22199227/normal" ilo-full-src="http://upics.yandex.ru/22199227/normal">
                </a>
            </div>
            <div class="col-sm-10 all-posts">
                <div class="title-container">
                    <h1><b><a href="http://imdagger.github.io" class="fn nickname">IMDagger</a></b></h1>
                </div>
                <div class="title-menu">
                    <ul class="nav nav-tabs" role="tablist">
                        <li class="active">
                            <a href="#">Дневник</a>
                        </li>
                        <li><a href="http://fotki.yandex.ru/users/imdagger">Фотки</a></li>
                        <li><a href="http://imdagger.github.io/pages/o-sebe.html">О себе</a></li>
                        <li><a href="http://imdagger.github.io/pages/rss-lenta.html">RSS-лента</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="row page-body">
<div class="col-sm-2 page-left">
<div class="row widget widget-photo">
    <a href="posts/2011/08/07/aga-popalsia/" class="b-user-photo__link"><img class="b-user-photo__img" src=" http://img-fotki.yandex.ru/get/5409/22199227.a/0_625fc_e780ccc7_L
?log_nocount=64720402854"></a>
</div><div class="row widget">
    <div class="widget-content b-user-info">
        <div class="widget__body">
            <div class="widget-user-info__age">
                <i class="widget-user-info__sex widget-user-info__sex_type_"></i> 26&nbsp;лет
            </div>
            <div class="widget-user-info__place">
                <a href="#">Гомель</a>,                <a href="#">Беларусь</a>            </div>
            <ul class="contacts">
                <li class="contact contact-type-email"><i></i><a href="mailto:imdagger@yandex.ru">imdagger@yandex.ru</a></li>
                <li class="contact contact-type-ya-online"><i></i>imdagger@ya.ru</li>
                <li class="contact contact-type-icq"><i></i>350395088</li>
            </ul>
        </div>
    </div>
</div>

<div class="row widget">
    <div class="widget-content">
        <div class="widget__title">
            <div class="widget__title-link">Метрика</div>
        </div>
        <div class="widget__body">
            <div class="widget-line">
              <!-- noindex -->
              <!-- googleoff: index -->
              <div class="widget-entry">
                <!-- Yandex.Metrika informer --><a href="https://metrika.yandex.ru/stat/?id=25746494&amp;from=informer" target="_blank" rel="nofollow"><img src="//bs.yandex.ru/informer/25746494/3_1_FFFFFFFF_EFEFEFFF_0_pageviews" style="width:88px; height:31px; border:0;" alt="Яндекс.Метрика" title="Яндекс.Метрика: данные за сегодня (просмотры, визиты и уникальные посетители)" onclick="try{Ya.Metrika.informer({i:this,id:25746494,lang:'ru'});return false}catch(e){}"/></a><!-- /Yandex.Metrika informer --><!-- Yandex.Metrika counter --><script type="text/javascript">(function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter25746494 = new Ya.Metrika({id:25746494, clickmap:true, trackLinks:true, accurateTrackBounce:true}); } catch(e) { } }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f, false); } else { f(); } })(document, window, "yandex_metrika_callbacks");</script><noscript><div><img src="//mc.yandex.ru/watch/25746494" style="position:absolute; left:-9999px;" alt="" /></div></noscript><!-- /Yandex.Metrika counter -->
                <!-- googleon: index -->
                <!-- /noindex -->
                </div>
            </div>
        </div>
    </div>
</div><div class="row widget">
    <div class="widget-content">
        <div class="widget__title">
            <div class="widget__title-link">Популярное в дневнике</div>
        </div>
        <div class="widget__body">
            <div class="widget-line">
                <div class="widget-entry">
                    <div class="widget-day__title">25&nbsp;июня</div>
                    <div class="widget-entry clearfix">
                        <div class="widget-entry__item">
                            <div class="widget-entry__title">
                                <a href="#" class="h-link">&nbsp;&nbsp;&nbsp; Висцеральная теория сна выглядит стр…</a>
                            </div>
                            <div class="widget-entry__info">2&nbsp;ответа</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div></div>

<div class="col-sm-10 all-posts">
<div class="row b-post-filter">
    <span class="pull-right">
        записи по
        <div class="btn-group">
            <span type="button" class="pseudo-link" data-toggle="dropdown">месяцам</span>
            <ul class="dropdown-menu dropdown-menu-right" role="menu">
                <li><a rel="nofollow" href="#" class="h-link">Нулябрь</a><li>
                <li><a rel="nofollow" href="#" class="h-link">Первябрь</a><li>
            </ul>
        </div> ·
        <div class="btn-group">
            <span type="button" class="pseudo-link" data-toggle="dropdown">меткам</span>
            <ul class="dropdown-menu dropdown-menu-right" role="menu">                <li>                    <a rel="nofollow" class="tag-1" href="http://imdagger.github.io/tag/oshibka.html" class="h-link">ошибка</a>                    <a rel="nofollow" class="tag-2" href="http://imdagger.github.io/tag/linux.html" class="h-link">linux</a>                    <a rel="nofollow" class="tag-2" href="http://imdagger.github.io/tag/iandeks.html" class="h-link">Яндекс</a>                    <a rel="nofollow" class="tag-2" href="http://imdagger.github.io/tag/icfpc.html" class="h-link">icfpc</a>                    <a rel="nofollow" class="tag-1" href="http://imdagger.github.io/tag/rabota.html" class="h-link">работа</a>                </li>                <li>                    <a rel="nofollow" class="tag-1" href="http://imdagger.github.io/tag/programmirovanie.html" class="h-link">программирование</a>                    <a rel="nofollow" class="tag-2" href="http://imdagger.github.io/tag/javascript.html" class="h-link">javascript</a>                    <a rel="nofollow" class="tag-2" href="http://imdagger.github.io/tag/eda.html" class="h-link">еда</a>                    <a rel="nofollow" class="tag-2" href="http://imdagger.github.io/tag/sborka.html" class="h-link">сборка</a>                    <a rel="nofollow" class="tag-1" href="http://imdagger.github.io/tag/zhizn.html" class="h-link">жизнь</a>                </li>                <li>                    <a rel="nofollow" class="tag-1" href="http://imdagger.github.io/tag/blender.html" class="h-link">blender</a>                    <a rel="nofollow" class="tag-1" href="http://imdagger.github.io/tag/python.html" class="h-link">python</a>                    <a rel="nofollow" class="tag-2" href="http://imdagger.github.io/tag/google.html" class="h-link">google</a>                    <a rel="nofollow" class="tag-2" href="http://imdagger.github.io/tag/emacs.html" class="h-link">emacs</a>                    <a rel="nofollow" class="tag-1" href="http://imdagger.github.io/tag/bge.html" class="h-link">bge</a>                </li>                <li>                    <a rel="nofollow" class="tag-2" href="http://imdagger.github.io/tag/java.html" class="h-link">java</a>                    <a rel="nofollow" class="tag-1" href="http://imdagger.github.io/tag/radost.html" class="h-link">радость</a>                    <a rel="nofollow" class="tag-1" href="http://imdagger.github.io/tag/bredni.html" class="h-link">бредни</a>                    <a rel="nofollow" class="tag-1" href="http://imdagger.github.io/tag/ia.html" class="h-link">Я</a>                    <a rel="nofollow" class="tag-1" href="http://imdagger.github.io/tag/nabrosok.html" class="h-link">набросок</a>                </li>            </ul>
        </div> ·
        <div class="btn-group">
            <span type="button" class="pseudo-link" data-toggle="dropdown">типам</span>
            <ul class="dropdown-menu dropdown-menu-right" role="menu">
                <li><a rel="nofollow" href="http://imdagger.github.io/category/description.html" class="h-link">обращение</a><li>
                <li><a rel="nofollow" href="http://imdagger.github.io/category/friend.html" class="h-link">дружба</a><li>
                <li><a rel="nofollow" href="http://imdagger.github.io/category/join.html" class="h-link">клубы</a><li>
                <li><a rel="nofollow" href="http://imdagger.github.io/category/link.html" class="h-link">ссылки</a><li>
                <li><a rel="nofollow" href="http://imdagger.github.io/category/mood.html" class="h-link">настроение</a><li>
                <li><a rel="nofollow" href="http://imdagger.github.io/category/photo.html" class="h-link">фото</a><li>
                <li><a rel="nofollow" href="http://imdagger.github.io/category/text.html" class="h-link">текст</a><li>
                <li><a rel="nofollow" href="http://imdagger.github.io/category/video.html" class="h-link">видео</a><li>
                <li><a rel="nofollow" href="http://imdagger.github.io/category/wishlist.html" class="h-link"></a><li>
            </ul>
        </div>
    </span>
</div>
    <div class="row b-post">
<div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="http://imdagger.github.io/author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="http://imdagger.github.io/posts/2010/04/13/razbor-poliota/" >
                13 апреля 2010 года, 17:33
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="http://imdagger.github.io/author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
            <noindex>
<div class="row tags-row">
    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/skrinkasting.html">скринкастинг</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/bge.html">bge</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/zapis.html">запись</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/izobrazhenie.html">изображение</a></span></div>
            </noindex>
            <div class="post-title">
<a class="no-link" href="http://imdagger.github.io/posts/2010/04/13/razbor-poliota/">Разбор полёта</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<p>Вот небольшой скрипт для записи видео из игрового режима по кардам в
изображения на диске:</p>
<div class="highlight"><pre><span class="pgcss-kn">from</span> <span class="pgcss-nn">Rasterizer</span> <span class="pgcss-kn">import</span> <span class="pgcss-n">makeScreenshot</span>
<span class="pgcss-n">cont</span> <span class="pgcss-o">=</span> <span class="pgcss-n">GameLogic</span><span class="pgcss-o">.</span><span class="pgcss-n">getCurrentController</span><span class="pgcss-p">()</span>
<span class="pgcss-n">owner</span> <span class="pgcss-o">=</span> <span class="pgcss-n">cont</span><span class="pgcss-o">.</span><span class="pgcss-n">owner</span>

<span class="pgcss-n">cur_time</span> <span class="pgcss-o">=</span> <span class="pgcss-n">owner</span><span class="pgcss-p">[</span><span class="pgcss-s">'timer'</span><span class="pgcss-p">]</span>
<span class="pgcss-n">last_time</span> <span class="pgcss-o">=</span> <span class="pgcss-n">owner</span><span class="pgcss-p">[</span><span class="pgcss-s">'start time'</span><span class="pgcss-p">]</span>
<span class="pgcss-n">end_time</span> <span class="pgcss-o">=</span> <span class="pgcss-n">owner</span><span class="pgcss-p">[</span><span class="pgcss-s">'end time'</span><span class="pgcss-p">]</span>

<span class="pgcss-k">if</span> <span class="pgcss-n">last_time</span> <span class="pgcss-o">&lt;</span> <span class="pgcss-n">end_time</span><span class="pgcss-p">:</span>
    <span class="pgcss-k">try</span><span class="pgcss-p">:</span>
        <span class="pgcss-n">cur_frame</span> <span class="pgcss-o">=</span> <span class="pgcss-n">GameLogic</span><span class="pgcss-o">.</span><span class="pgcss-n">cur_frame</span>
    <span class="pgcss-k">except</span><span class="pgcss-p">:</span>
        <span class="pgcss-n">cur_frame</span> <span class="pgcss-o">=</span> <span class="pgcss-mi">0</span>

    <span class="pgcss-n">delta</span> <span class="pgcss-o">=</span> <span class="pgcss-mi">1</span> <span class="pgcss-o">/</span> <span class="pgcss-n">owner</span><span class="pgcss-p">[</span><span class="pgcss-s">'per second'</span><span class="pgcss-p">]</span>
    <span class="pgcss-n">image_name</span> <span class="pgcss-o">=</span> <span class="pgcss-n">owner</span><span class="pgcss-p">[</span><span class="pgcss-s">'path'</span><span class="pgcss-p">]</span> <span class="pgcss-o">+</span> <span class="pgcss-s">'</span><span class="pgcss-si">%04d</span><span class="pgcss-s">'</span>

    <span class="pgcss-k">while</span> <span class="pgcss-n">cur_time</span> <span class="pgcss-o">&gt;</span> <span class="pgcss-n">last_time</span><span class="pgcss-p">:</span>
        <span class="pgcss-n">last_time</span> <span class="pgcss-o">+=</span> <span class="pgcss-n">delta</span>
        <span class="pgcss-n">cur_frame</span> <span class="pgcss-o">+=</span> <span class="pgcss-mi">1</span>
        <span class="pgcss-n">makeScreenshot</span><span class="pgcss-p">(</span><span class="pgcss-n">image_name</span> <span class="pgcss-o">%</span> <span class="pgcss-n">cur_frame</span><span class="pgcss-p">)</span>

    <span class="pgcss-n">GameLogic</span><span class="pgcss-o">.</span><span class="pgcss-n">cur_frame</span> <span class="pgcss-o">=</span> <span class="pgcss-n">cur_frame</span>
    <span class="pgcss-n">owner</span><span class="pgcss-p">[</span><span class="pgcss-s">'start time'</span><span class="pgcss-p">]</span> <span class="pgcss-o">=</span> <span class="pgcss-n">last_time</span>
</pre></div>
<p>Скрипт нужно вызывать по событию изменения свойства таймера. Следующие
параметры доступны через свойства объекта и регулируют поведение
скрипта:</p>
<ul class="simple">
<li>timer — тип Timer, используется для вызова скрипта и определения
текущего времени в BGE</li>
<li>start time — задаётся в секундах время начала съёмки видео,
используется также скриптом во внутренних целях, опираться на него
после запуска скрипта не стоит другим объектам, т.к. оно
увеличивается после начала съёмки</li>
<li>per second — количество необходимых кадров в секунду</li>
<li>end time — время, когда нужно остановить создание снимков экрана</li>
<li>path — пусть, куда будут складываться снимки экрана вида:
0001.расширение .. NNNN.расширение, тип сохраняемого изображения
задаётся там, где и для рендеринга. Путь должен быть со / (или \ под
другой осью) на конце.</li>
</ul>
<p class="text-center"><a class="reference external" href="http://fotki.yandex.ru/users/imdagger/view/177837/"><img alt="image0" src="http://img-fotki.yandex.ru/get/4209/imdagger.6/0_2b6ad_53d65419_L" title="image0"/></a></p>
<p class="cut"><a class="h-link reference internal" data-toggle="collapse" href="#cut_65237584">А теперь по порядку как он работает:</a></p>
<div class="collapse" id="cut_65237584">
<div class="highlight"><pre><span class="pgcss-c"># локальные имена быстрее многочисленных обращений к модулю</span>
<span class="pgcss-kn">from</span> <span class="pgcss-nn">Rasterizer</span> <span class="pgcss-kn">import</span> <span class="pgcss-n">makeScreenshot</span>

<span class="pgcss-c"># получение текущего объекта, т.к. его свойства — параметры системы</span>
<span class="pgcss-n">cont</span> <span class="pgcss-o">=</span> <span class="pgcss-n">GameLogic</span><span class="pgcss-o">.</span><span class="pgcss-n">getCurrentController</span><span class="pgcss-p">()</span>
<span class="pgcss-n">owner</span> <span class="pgcss-o">=</span> <span class="pgcss-n">cont</span><span class="pgcss-o">.</span><span class="pgcss-n">owner</span>

<span class="pgcss-c"># start time служит как время записи последнего кадра, а также стартовым временем</span>
<span class="pgcss-n">cur_time</span> <span class="pgcss-o">=</span> <span class="pgcss-n">owner</span><span class="pgcss-p">[</span><span class="pgcss-s">'timer'</span><span class="pgcss-p">]</span>
<span class="pgcss-n">last_time</span> <span class="pgcss-o">=</span> <span class="pgcss-n">owner</span><span class="pgcss-p">[</span><span class="pgcss-s">'start time'</span><span class="pgcss-p">]</span>
<span class="pgcss-n">end_time</span> <span class="pgcss-o">=</span> <span class="pgcss-n">owner</span><span class="pgcss-p">[</span><span class="pgcss-s">'end time'</span><span class="pgcss-p">]</span>


<span class="pgcss-c"># если время последней съёмки не привысило допустимую верхнюю границу,</span>
<span class="pgcss-c"># то нужно ещё сделать кадров</span>
<span class="pgcss-k">if</span> <span class="pgcss-n">last_time</span> <span class="pgcss-o">&lt;</span> <span class="pgcss-n">end_time</span><span class="pgcss-p">:</span>
    <span class="pgcss-c"># текущий кадр хранится в GameLogic.cur_frame, если он ещё не создан — произошло</span>
    <span class="pgcss-c"># исключение, то принять значение как 0</span>
    <span class="pgcss-k">try</span><span class="pgcss-p">:</span>
        <span class="pgcss-n">cur_frame</span> <span class="pgcss-o">=</span> <span class="pgcss-n">GameLogic</span><span class="pgcss-o">.</span><span class="pgcss-n">cur_frame</span>
    <span class="pgcss-k">except</span><span class="pgcss-p">:</span>
        <span class="pgcss-n">cur_frame</span> <span class="pgcss-o">=</span> <span class="pgcss-mi">0</span>


    <span class="pgcss-c"># приращение на один кадр расчитывается как обратное числу кадров в секунду</span>
    <span class="pgcss-n">delta</span> <span class="pgcss-o">=</span> <span class="pgcss-mi">1</span> <span class="pgcss-o">/</span> <span class="pgcss-n">owner</span><span class="pgcss-p">[</span><span class="pgcss-s">'per second'</span><span class="pgcss-p">]</span>
    <span class="pgcss-c"># шаблон для сохранения файла с изображением,</span>
    <span class="pgcss-c"># %04d принуждает добавлять лидирующие нули, если число &lt;1000</span>
    <span class="pgcss-n">image_name</span> <span class="pgcss-o">=</span> <span class="pgcss-n">owner</span><span class="pgcss-p">[</span><span class="pgcss-s">'path'</span><span class="pgcss-p">]</span> <span class="pgcss-o">+</span> <span class="pgcss-s">'</span><span class="pgcss-si">%04d</span><span class="pgcss-s">'</span>

    <span class="pgcss-c"># если оказалось, что время создания последнего снимка экрана</span>
    <span class="pgcss-c"># было раньше, чем текущее время, то пора записать немного кадров</span>
    <span class="pgcss-k">while</span> <span class="pgcss-n">cur_time</span> <span class="pgcss-o">&gt;</span> <span class="pgcss-n">last_time</span><span class="pgcss-p">:</span>
        <span class="pgcss-c"># приращивается время последней съёмки и номер кадра</span>
        <span class="pgcss-n">last_time</span> <span class="pgcss-o">+=</span> <span class="pgcss-n">delta</span>
        <span class="pgcss-n">cur_frame</span> <span class="pgcss-o">+=</span> <span class="pgcss-mi">1</span>
        <span class="pgcss-c"># если получится, что скрипт отстал по какой-то причине, например компьтер</span>
        <span class="pgcss-c"># не достаточно производительный или что-то ему мешало, или на предыдущем</span>
        <span class="pgcss-c"># кадре работало что-то, что затормозило всё отрисовку, то при помощи этого</span>
        <span class="pgcss-c"># цикла он дополнит одинаковыми кадрами этот участок (лучше, чем самому</span>
        <span class="pgcss-c"># потом думать, где провалы скорости и вручную дополнять), также он</span>
        <span class="pgcss-c"># увеличит время последней съёмки и не позволит лишний раз вызывать</span>
        <span class="pgcss-c"># makeScreenshot в неподходящий момент, т.е. этот цикл позволяет делать</span>
        <span class="pgcss-c"># снимки синхронно с положенным временем</span>

        <span class="pgcss-c"># записывается кадр на диск, шаблон image\_name расширяется при помощи</span>
        <span class="pgcss-c"># cur_fame параметра (содержит номер текущего кадра)</span>
        <span class="pgcss-n">makeScreenshot</span><span class="pgcss-p">(</span><span class="pgcss-n">image_name</span> <span class="pgcss-o">%</span> <span class="pgcss-n">cur_frame</span><span class="pgcss-p">)</span>

    <span class="pgcss-c"># локальные переменные быстрее работают, чем свойства, но их в конце стоит обратно</span>
    <span class="pgcss-c"># сохранить на места</span>
    <span class="pgcss-n">GameLogic</span><span class="pgcss-o">.</span><span class="pgcss-n">cur_frame</span> <span class="pgcss-o">=</span> <span class="pgcss-n">cur_frame</span>
    <span class="pgcss-n">owner</span><span class="pgcss-p">[</span><span class="pgcss-s">'start time'</span><span class="pgcss-p">]</span> <span class="pgcss-o">=</span> <span class="pgcss-n">last_time</span>
</pre></div>
</div>                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div><div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="http://imdagger.github.io/author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="http://imdagger.github.io/posts/2010/04/11/novyi-bild/" >
                11 апреля 2010 года, 20:22
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="http://imdagger.github.io/author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
            <noindex>
<div class="row tags-row">
    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/vozmozhnosti.html">возможности</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/bge.html">bge</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/sborka.html">сборка</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/forum.html">форум</a></span></div>
            </noindex>
            <div class="post-title">
<a class="no-link" href="http://imdagger.github.io/posts/2010/04/11/novyi-bild/">Новый билд</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<p>&nbsp; &nbsp; Завёл себе отдельную
&nbsp;<a class="reference external" href="http://blender3d.org.ua/forum/game/145.html">ветку</a> на форуме
BlenderУкраина. Туда буду выкладывать ссылки на билды, а сюда всякие
мысли и информацию по использованию. Второй
<a class="reference external" href="http://blender3d.org.ua/forum/game/145.html#1">пост</a> вообще должен
был быть про новый билд, но.. Яндекс.Народ почему-то сейчас принимает
файл так доооо..лго.. Говорит 58 минут ждать, но я сейчас столько ждать
не могу, поэтому пойду домой, а ссылку получу завтра и кину на форум
отдельным постом.</p>
                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div><div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="http://imdagger.github.io/author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="http://imdagger.github.io/posts/2010/03/30/http-i-bge/" >
                30 марта 2010 года, 21:54
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="http://imdagger.github.io/author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
            <noindex>
<div class="row tags-row">
    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/bge.html">bge</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/http.html">HTTP</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/primer.html">пример</a></span></div>
            </noindex>
            <div class="post-title">
<a class="no-link" href="http://imdagger.github.io/posts/2010/03/30/http-i-bge/">HTTP и BGE</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<p>Сделал небольшой пример, где из BGE посредством Python извлекается
число страниц из произвольной ветки на форуме Blender Украина.
Использовал <strong>urllib2</strong> для получения данных посредством GET запроса и
класс <strong>HTMLParser</strong> &nbsp;из библиотеки HTMLParser (от него нужно
наследоваться) для разбора HTML и получения числа страниц в ветке.
Пример нужно дорабатывать, т.к. он блокирует BGE, пока не получит всю
страницу. Лучше использовать какой-нибудь неблокирующий способ получения
данных. Например сделать urlopen, объект сохранить в GameLogic, а затем
блоками читать данные в неблокирующем режиме, используя пульсирующий
сенсор Always. Это позволит получить порцию данных, отрисовать BGE
сцену, снова получить данные и т.д. А в конце присвоить число страниц.</p>
<p><a class="reference external" href="http://blender3d.org.ua/forum/game/45-428.html#6884">Ссылка</a> на
форуме, где я приложил файл.</p>
                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div><div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="http://imdagger.github.io/author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="http://imdagger.github.io/posts/2010/03/18/detsimatsiia/" >
                18 марта 2010 года, 19:32
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="http://imdagger.github.io/author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
            <noindex>
<div class="row tags-row">
    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/detsimatsiia.html">децимация</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/bge.html">bge</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/umenshenie.html">уменьшение</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/ponizhenie.html">понижение</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/poligony.html">полигоны</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/blender.html">blender</a></span></div>
            </noindex>
            <div class="post-title">
<a class="no-link" href="http://imdagger.github.io/posts/2010/03/18/detsimatsiia/">Децимация</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<p>Хм… пожалуй скрипт Mesh → Scripts → Poly Reduce достаточно хорош и я
зря на него не обращал внимания. Когда мне нужно было создать текст в
BGE мешем, но не использовать много треугольников, то я применял
модификатор Decimate (обычно я его применяю из-за того, что он не
трогает сам меш). Но в случае с текстом мне всё равно приходится его
конвертировать при помощи <kbd class="kbd">
Alt + C</kbd>
. Я попробовал скрипт и результат
меня впечатлил:</p>
<p class="text-center"><a class="reference external" href="http://fotki.yandex.ru/users/imdagger/view/161814/"><img alt="image0" src="http://img-fotki.yandex.ru/get/3814/imdagger.6/0_27816_a68b03e6_L" title="image0"/></a></p>
<p>Первая строка — исходный меш, вторая —при помощи Decimate модификатора с
параметром 0.994 (даже при таком высоком параметре букву <strong>t</strong> оно
испортило, я заметил, что он очень не любит буквы T и t, всё время их
норовит слить в единое целое) , а третья строка — количество полигонов
понижено с коэффициентом 0.3, т.е. было <strong>7681</strong>, а стало <strong>551</strong>. И на
качестве это никак не отразилось (что не скажешь про Decimate):</p>
<p class="text-center"><a class="reference external" href="http://fotki.yandex.ru/users/imdagger/view/161815/"><img alt="image1" src="http://img-fotki.yandex.ru/get/3812/imdagger.6/0_27817_d6b5a0d8_L" title="image1"/></a></p>                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div><div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="http://imdagger.github.io/author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="http://imdagger.github.io/posts/2010/03/11/dinamicheskaia-zagruzka-iz-skriptov/" >
                11 марта 2010 года, 14:50
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="http://imdagger.github.io/author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
            <noindex>
<div class="row tags-row">
    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/blender.html">blender</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/vozmozhnosti.html">возможности</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/bge.html">bge</a></span></div>
            </noindex>
            <div class="post-title">
<a class="no-link" href="http://imdagger.github.io/posts/2010/03/11/dinamicheskaia-zagruzka-iz-skriptov/">Динамическая загрузка из скриптов</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<p>Добавил в BGE вызов функций отложенной загрузки объектов сцены из
другого blend-файла, а также функцию отложенной выгрузки. До этого можно
было лишь пользоваться актуатором:</p>
<div class="highlight"><pre><span class="pgcss-n">cc</span> <span class="pgcss-o">=</span> <span class="pgcss-n">GameLogic</span><span class="pgcss-o">.</span><span class="pgcss-n">getCurrentController</span><span class="pgcss-p">()</span>
<span class="pgcss-n">blend_loader</span> <span class="pgcss-o">=</span> <span class="pgcss-n">cc</span><span class="pgcss-o">.</span><span class="pgcss-n">actuators</span><span class="pgcss-p">[</span><span class="pgcss-s">&#39;load&#39;</span><span class="pgcss-p">]</span>
<span class="pgcss-n">blend_loader</span><span class="pgcss-o">.</span><span class="pgcss-n">scene</span> <span class="pgcss-o">=</span> <span class="pgcss-s">&#39;Room stuff&#39;</span>
<span class="pgcss-n">room_number</span> <span class="pgcss-o">=</span> <span class="pgcss-mi">112</span>
<span class="pgcss-n">blend_loader</span><span class="pgcss-o">.</span><span class="pgcss-n">blendFileName</span> <span class="pgcss-o">=</span> <span class="pgcss-s">&#39;//room</span><span class="pgcss-si">%s</span><span class="pgcss-s">/stuff/main.blend&#39;</span> <span class="pgcss-o">%</span> <span class="pgcss-n">room_number</span>
<span class="pgcss-n">cc</span><span class="pgcss-o">.</span><span class="pgcss-n">activate</span><span class="pgcss-p">(</span><span class="pgcss-n">blend_loader</span><span class="pgcss-p">)</span>
</pre></div>
<p>blend_loader загрузит сцену из файла с относительным путём
<strong>//room112/stuff/main.blend</strong>,&nbsp;<strong>blendFileName</strong> это свойство,
которое указывает имя файла. так способом можно загружать за одну
итерацию BGE только количество сцен равное количеству активированных
актуаторов. С выгрузкой аналогично. Такой подход может быть удобным,
если нужно по мере загрузки обновлять изображение на экране и
отрисовывать, например полосу прогресса загрузки.</p>
<p>Но бывает нужно за один подход загрузить несколько групп объектов.
Немноог напоминает транзакции из баз данных, т.е. ничего не должно
вклиниваться между загрузкой двух сцен, ни отрисовка, ни другие события
актуаторов или сенсоров. Эту проблему решит добавка отдельного API для
загрузки не через актуаторы:</p>
<div class="highlight"><pre><span class="pgcss-n">room_file_name</span> <span class="pgcss-o">=</span> <span class="pgcss-s">&#39;//room</span><span class="pgcss-si">%s</span><span class="pgcss-s">/stuff/main.blend&#39;</span>
<span class="pgcss-n">room_number</span> <span class="pgcss-o">=</span> <span class="pgcss-mi">112</span>
<span class="pgcss-n">GameLogic</span><span class="pgcss-o">.</span><span class="pgcss-n">mergeBlendFile</span><span class="pgcss-p">(</span><span class="pgcss-s">&#39;Room Stuff&#39;</span><span class="pgcss-p">,</span> \
             <span class="pgcss-s">&#39;//room</span><span class="pgcss-si">%s</span><span class="pgcss-s">/stuff/main.blend&#39;</span> <span class="pgcss-o">%</span> <span class="pgcss-n">room_number</span><span class="pgcss-p">)</span>
 <span class="pgcss-n">room_number</span> <span class="pgcss-o">=</span> <span class="pgcss-mi">115</span>
 <span class="pgcss-n">GameLogic</span><span class="pgcss-o">.</span><span class="pgcss-n">unmergeBlendFile</span><span class="pgcss-p">(</span><span class="pgcss-s">&#39;Room Stuff&#39;</span><span class="pgcss-p">,</span> \
             <span class="pgcss-n">room_file_name</span> <span class="pgcss-o">%</span> <span class="pgcss-n">room_number</span><span class="pgcss-p">,</span> <span class="pgcss-bp">True</span><span class="pgcss-p">)</span>
</pre></div>
<p>Т.е. в сцену, где расположен объект, на котором исполняется данных
скрипт контроллера, добавить объекты из сцены&nbsp;Room
Stuff&nbsp;//room112/stuff/main.blend <u class="underline">
на следующей итерации</u>
. И тут же
потребовать выгрузки на следующей итерации сцены
из&nbsp;//room115/stuff/main.blend, True указывает, что это <strong>Forced</strong> режим
(когда BGE пробудет удалить и blend-файл из памяти, если никто его не
использует). False — обычный режим, BGE удаляет объекты, но blend-файл
оставляет в памяти, чтобы в следующий раз не считывать с диска (вдруг
его опять скоро попросят загрузиться).</p>
<p>Нужно учитывать, что загрузка и выгрузка происходят на новой
итерации, но… проверка при выгрузке происходит сразу. Т.е., если
попросить загрузить <strong>A</strong> и тут же попросить выгрузить <strong>A</strong>, то
загрузка будет (на новой итерации), а при выгрузке скажет, что файл ещё
не загрузился (сразу после исполнения функции).</p>
<p>Соберусь с силами и сделаю ещё один билд. Нужно подправить
функционал связанный с оверлеями :) Я рассчитываю его тоже включить в
сборку.</p>
                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div><div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="http://imdagger.github.io/author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="http://imdagger.github.io/posts/2010/03/10/iandeks-tormozit/" >
                10 марта 2010 года, 21:52
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="http://imdagger.github.io/author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
            <noindex>
<div class="row tags-row">
    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/bge.html">bge</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/iandeks.html">Яндекс</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/pechal.html">печаль</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/blender.html">blender</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/ia.html">Я</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/zol.html">зол</a></span></div>
            </noindex>
            <div class="post-title">
<a class="no-link" href="http://imdagger.github.io/posts/2010/03/10/iandeks-tormozit/">Яндекс тормозит</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<p>Я ужасно зол! Яндекс тормозит! Все сервисы, кажется он нас
дискриминирует по IP, это случается вечером (и не у меня одного,
провайдера разные, но есть и те у кого провайдер совсем в другой подсети
и не тормозит). Ничего больше не тормозит, только он, т.е. эт оне
проблема зоны ru! Это не выносимо, т.к. ping-гуется быстро, Jabber
работает быстро, а 80 порт для HTTP тормозит зверски.
Через webproxy.ru работает более менее, т.е. хотя бы не по 30-40 минут
грузится 1-2 килобайта. И случается только вечером… :( А я так хотел
разного интересного написать про BGE.</p>
                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div><div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="http://imdagger.github.io/author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="http://imdagger.github.io/posts/2010/02/24/skroll/" >
                24 февраля 2010 года, 21:28
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="http://imdagger.github.io/author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
            <noindex>
<div class="row tags-row">
    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/blender.html">blender</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/bge.html">bge</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/last_gateway_to_hell.html">last_gateway_to_hell</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/skroll.html">скролл</a></span></div>
            </noindex>
            <div class="post-title">
<a class="no-link" href="http://imdagger.github.io/posts/2010/02/24/skroll/">Скролл</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<p>Открыл я файл с исходным кодом Blender в том месте, где должен
обрабатываться элемент интерфейса такой, как полоса прокрутки и увидел
то, что и ожидал:</p>
<div class="highlight"><pre><span class="pgcss-k">case</span> <span class="pgcss-nl">SCROLL</span><span class="pgcss-p">:</span>
   <span class="pgcss-cm">/* DrawBut(b, 1); */</span>
   <span class="pgcss-cm">/* do_scrollbut(b); */</span>
   <span class="pgcss-cm">/* DrawBut(b,0); */</span>
   <span class="pgcss-k">break</span><span class="pgcss-p">;</span>
</pre></div>
<p>Логично, что функция полосы прокрутки не задокументирована и не
работает. Поэтому и в LuxRender экспортёре реализуют свой класс scrollbar.
Я взял этот класс и посмотрел как он определяет позицию она и
работает в общем. Переделал его под свои нужды, т.к. в экспортёре он
высотой во всё окно и прижат к правому краю. Мне нужна произвольная
позиция и использование уже существующего класса контроллера <code class="code">
Bag</code>
,
который реализует метода <code class="code">
scroll_up</code>
, <code class="code">
scroll_down</code>
 и <code class="code">
pos</code>
. Новый класс
<code class="code">
base.editor_utils.Scrollbar</code>
 принимает в качестве аргумента контроллер
рюкзака, получается такое своеобразное представление-контроллер, которое
обрабатывает и события, передавая их в настоящий контроллер. Сразу
заработало перемещение ползунка при нажатии на кноки, т.к. класс себя
позиционирует как дополнительное представление контроллера рюкзака.</p>
<p class="text-center"><a class="reference external" href="http://fotki.yandex.ru/users/imdagger/view/142871/"><img alt="image0" src="http://img-fotki.yandex.ru/get/3908/imdagger.5/0_22e17_8e398c87_L" title="image0"/></a></p>                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div><div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="http://imdagger.github.io/author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="http://imdagger.github.io/posts/2010/02/17/vykroil-vremia/" >
                17 февраля 2010 года, 20:42
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="http://imdagger.github.io/author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
            <noindex>
<div class="row tags-row">
    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/blender.html">blender</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/bge.html">bge</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/x-ray.html">x-ray</a></span></div>
            </noindex>
            <div class="post-title">
<a class="no-link" href="http://imdagger.github.io/posts/2010/02/17/vykroil-vremia/">Выкроил время</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<p>&nbsp; &nbsp; Ну что ж, … готовься X-Ray к новому бою, я снова нашёл на тебя
время. Сегодня отнесу домой текущую черновую ревизию и дома немного
доработаю код и ускорю. Что и как необходимо сделать за сегодня:</p>
<ol class="arabic simple">
<li>Сделать наследника класса RAS_MaterialBucket, который будет
разделять &nbsp;в разные списки оверлейные меши от обычных. Это позволит
уже ещё до рендеринга кадра знать: включить GL_STENCIL_TEST или
нет. Включение чуть-чуть замедлит отрисовку, но оверлейные объекты
отрисовываются два раза. Таким образом, если нет оверлея, но «никто
не пострадает»</li>
<li>По просьбам трудящихся добавлю объекты, которые могут проявляться
поверх всего. Например, стрелочка на карте, куда идти и т.д.</li>
<li>Попробую решить проблему с рендерингом объектов с одинаковым
приоритетом и флагом оверлейности.</li>
</ol>
<p>&nbsp; &nbsp; Главное это всё успеть сегодня ночью, т.к. времени в обрез, нужно
заниматься и другими делами, которые уже в жо дедлайне.</p>
                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div><div class="panel panel-video">
    <div class="panel-heading b-post-type b-post-type-video">
        <b class="b-user">
            <a class="b-user__link" href="http://imdagger.github.io/author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
вывесил видео        <span class="pull-right b-date">
            <a class="h-link" href="http://imdagger.github.io/posts/2010/02/05/chernovoi-variant-x-ray/" >
                5 февраля 2010 года, 13:44
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="http://imdagger.github.io/author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
            <noindex>
<div class="row tags-row">
    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/blender.html">blender</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/skrinkasting.html">скринкастинг</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/bge.html">bge</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/x-ray.html">x-ray</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/vozmozhnosti.html">возможности</a></span></div>
            </noindex>
            <div class="post-title">
Черновой вариант X-Ray            </div>
            <div class="row post-body">
                <div class="b-text">
<div class="text-center"><div class="yavideo" align="left"></div><object id="flash" width="450" height="370" data="http://flv.video.yandex.ru/lite/imdagger/8djwqarlop.1311/" type="application/x-shockwave-flash"><param value="http://flv.video.yandex.ru/lite/imdagger/8djwqarlop.1311/" name="movie"><param value="high" name="quality"><param value="transparent" name="wmode"><param value="#ffffff" name="bgcolor"><param value="true" name="allowfullscreen"><param value="sameDomain" name="allowscriptaccess"><param value="scale" name="scale"></object></div><p>Сделал вчера этот X-Ray, пока работает не полностью так хорошо, как я
хотел был, но видео записал и вцелом доволен :). Еёщ не работает
непрозрачность, фильтры и установка из свойства, приоритеты работают, но
если приоритеты одинаковые, то проявляется неадекватное поведение
оверлейных объектов (выводится один поверх другого в зависимоти от
порядка добавки, а не от дальности). Есть над чем ещё поработать и
поработать старательно.</p>
                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div><div class="panel panel-text">
    <div class="panel-heading b-post-type b-post-type-text">
        <b class="b-user">
            <a class="b-user__link" href="http://imdagger.github.io/author/imdagger.html"><b class="b-user__first-letter">I</b>MDagger</a>
        </b>
написал        <span class="pull-right b-date">
            <a class="h-link" href="http://imdagger.github.io/posts/2010/02/04/a-larchik-prosto-otkryvalsia/" >
                4 февраля 2010 года, 16:16
            </a>
        </span>
    </div>
    <div class="panel-body">
        <div class="col-sm-1 b-post__layout-left">
            <a href="http://imdagger.github.io/author/imdagger.html"><img src="http://upics.yandex.ru/22199227/middle"></a>
        </div>
        <div class="col-sm-11 b-right-col">
            <noindex>
<div class="row tags-row">
    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/blender.html">blender</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/vozmozhnosti.html">возможности</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/bge.html">bge</a></span>,    <span class="tag"><a rel="nofollow" class="h-link" href="http://imdagger.github.io/tag/x-ray.html">x-ray</a></span></div>
            </noindex>
            <div class="post-title">
<a class="no-link" href="http://imdagger.github.io/posts/2010/02/04/a-larchik-prosto-otkryvalsia/">А ларчик просто открывался</a>            </div>
            <div class="row post-body">
                <div class="b-text">
<p>Сел вчера ночью дома за машинку. Решил основательно потестировать,
почему код, который я добавляю в отрисовку в Blender с трафаретным
буфером не работает. Написал малюсенький кусочек кода для включения
GL_STENCIL_TEST и вывода треугольника, отключил вывод мешей самого
Ketsji. Включил функцию GL_NEVER, что означало, что я хочу использовать
трафарет, но мне нужно изображение на экране. И я получил такой же
результат, как на работе — изображение выводилось и игнорировало то, что
мне нужна проверка трафарета. Тогда я добавил после каждой gl-функции
строчку <code class="code">
printf(&quot;%d \n&quot;, glGetError());</code>
. И о чудо! Я увидел код
ошибки 1280 для glEnable(GL_STENCIL_TEST), а для включения функций
были ошибки 1282. Вторая ошибка меня не смутила — мало ли, она гласит,
что это неверная операция или невозможна в данном контексте. А вот
первая посеяла в моём мозгу мысль: «Не может быть! Это же значит, что я
передал неверную константу, но она же определена в заголовочном файле
для драйвера карты!».</p>
<p>Ещё больше меня смущало, что тест трафарета работает на моих
отдельных примерах. Но… все они создавали окно при помощи GLUT. Я нашёл
какой-то завалявшийся пример в /usr/share/doc на Perl’е для OpenGL через
SDL и добавил туда проверку трафарета. И.. опять таже ошибка, хотя на
работе Mesa говорит всё время, что ошибки нет. Самое главное и общее тут
выходит — трафарет не работает.</p>
<p>Хорошенько выспавшись я осознал, что &nbsp;нужно искать, где Blender
создаёт окно для вывода контекста. Я рылся в <strong>blender/source</strong> и ничего
не мог найти подходящего. Но потом я нашёл весь платформозависимой код в
<strong>blender/intern/ghost</strong>. Это был файл GHOST_WindowX11.cpp (для винды —
GHOST_WindowWin32.cpp).</p>
<p>И стоило сказать волшебное слово <code class="code">
attributes[i++] =
GLX _STENCIL _SIZE; attributes[i++] = 1;</code>
 — и проверка трафарета
заработала, потому что я включил при создании окна эту возможность.
Аналогично в файле для Win32 нужно подправить массив параметров для
создания окна.</p>
<p>P.S. Ура! Значит скоро обещанный X-Ray в BGE заработает.</p>
                </div>
            </div>
            <div class="row comments-row">
                <span><a class="pseudo-link b-candy b-comment-shortcut"><i class="b-ico"></i>ответить</a></span>
            </div>
        </div>
    </div>
</div>        <div class="panel panel-default">
            <div class="panel-body more">
                <span class="less-prev"><a class="h-link" href="http://imdagger.github.io/tag/bge2.html">Назад</a></span>
                <span class="more-next"><a class="h-link" href="http://imdagger.github.io/tag/bge4.html">Ещё записи</a></span>
            </div>
        </div>
    </div>
</div>
        </div>
    </body>
</html>